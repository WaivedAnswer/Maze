(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{37:function(e,t,n){},39:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(24),i=n.n(c),o=(n(37),n(5)),s=n(6),l=n.n(s),u=n(10),d=(n(39),r.a.createContext()),h=n(8),p=-1,m=1,b=2,j=3,f=4,g=5,v=function e(t,n,a,r,c){Object(h.a)(this,e),this.coord=t,this.type=n,this.hasItem=a,this.item=r,this.tokenType=c},O=n(9),x=1,y=2,k=3,w=4,S=function(){function e(t,n,a,r,c){Object(h.a)(this,e),this.id=t,this.coord=n,this.selections=a,this.escaped=r,this.type=c}return Object(O.a)(e,[{key:"isMySelection",value:function(){return this.selections.find((function(e){return e.isSelf}))}}]),e}(),C=0,N=1,T=2,E=3,I=4,M=0,P=1,R=2,L=3,D=4,U=n.p+"static/media/up.552f859e.png",A=n.p+"static/media/down.40f8ab30.png",B=n.p+"static/media/left.aa0f5ff4.png",J=n.p+"static/media/right.9a984c67.png",W=n.p+"static/media/coins_new.2254d122.png",H=n.p+"static/media/timer.c21cbb42.png",z=0,G=1,_=2,F=function e(t,n){Object(h.a)(this,e),this.type=t,this.tokenType=n},X=n(16),Y=function(e,t){return Object(X.a)(Object(X.a)({},function(e,t){var n=Math.max(e.left,t.left);return n<e.right-t.width?{left:n}:{right:window.innerWidth-e.right}}(e,t)),function(e,t){var n=Math.max(e.top,t.top);return n<e.bottom-t.height?{top:n}:{bottom:window.innerHeight-e.bottom}}(e,t))},K=function(e,t){if(!e.current||!t.current)return null;var n=e.current.getBoundingClientRect(),a=t.current.getBoundingClientRect();if(n.top<=a.bottom&&n.left<=a.right&&n.bottom>=a.top&&n.right>=a.left)return null;var r=a.top-n.bottom,c=n.top-a.bottom,i=a.left-n.right,o=n.left-a.right,s=Math.max(r,c,i,o),l=Y(a,n);if(r===s)return Object(X.a)({direction:M},l);if(c===s)return Object(X.a)({direction:P,bottom:window.innerHeight-a.bottom},l);if(o===s)return Object(X.a)({direction:L},l);if(i===s)return Object(X.a)({direction:R},l);throw new Error("No direction specified")},Q=n.p+"static/media/axe2.3337d039.png",q=n.p+"static/media/sword.003d0d39.png",Z=n.p+"static/media/arrows2.6d27d5a7.png",V=n.p+"static/media/potion.dc85f7b3.png",$=function(e){switch(e){case x:return{img:Q,color:"orange"};case k:return{img:q,color:"yellow"};case w:return{img:Z,color:"green"};case y:return{img:V,color:"purple"};default:throw new Error("Invalid token type")}},ee=n(0),te=function(e){var t,n=e.indicatorImg,a=e.indicatorInfo,r={display:"flex",bottom:a.bottom,top:a.top,left:a.left,right:a.right,justifyContent:"center",alignItems:"center"},c={height:a.imgScale,width:a.imgScale},i="offscreen";switch(a.tokenType){case k:i+=" barbarian";break;case x:i+=" dwarf";break;case w:i+=" elf";break;case y:i+=" mage"}switch(a.direction){case M:t=U,r.flexDirection="column";break;case P:t=A,r.flexDirection="column-reverse";break;case R:t=B,r.flexDirection="row";break;case L:t=J,r.flexDirection="row-reverse";break;default:throw new Error("Unsupported offscreen direction")}return Object(ee.jsxs)("div",{className:i,style:r,children:[Object(ee.jsx)("img",{src:t,className:"offscreen-direction",alt:"offscreen direction"}),Object(ee.jsx)("img",{src:n,style:c,className:"offscreen-image",alt:"offscreen indicator"})]})},ne=function(e){var t,n=e.item,r=e.gameState,c=Object(a.useState)(null),i=Object(o.a)(c,2),s=i[0],l=i[1],u=Object(a.useRef)(null),h=Object(a.useContext)(d);Object(a.useEffect)((function(){var e=h;function t(){var e=K(u,h);e&&(e.tokenType=n.tokenType),l(e)}return e.current.addEventListener("scroll",t),t(),function(){e.current.removeEventListener("scroll",t)}}),[h]);var p="item",m={},b=!1;switch(n.type){case z:t=W,p+=" coin";break;case G:t=H,p+=" time";break;case _:var j=$(n.tokenType);t=j.img,p+=" weapon",m.backgroundColor=j.color,r!==N&&(m.opacity="30%"),b=null!==s&&r===N;break;default:throw new Error("Unknown item type: "+JSON.stringify(n))}return Object(ee.jsxs)("div",{ref:u,className:p,style:m,children:[Object(ee.jsx)("img",{src:t,alt:"item"}),b?Object(ee.jsx)(te,{indicatorInfo:s,indicatorImg:t}):""]})},ae=function(e){var t=e.tile,n=e.gameState;return Object(ee.jsx)("div",{className:"tile",children:t.hasItem?Object(ee.jsx)(ne,{item:t.item,gameState:n}):null})},re=function(e){var t,n=e.tile,a=e.getTileDirection,r=e.gameState,c="tile-connect",i=a(n);if(!(i!==D&&r===C))return Object(ee.jsx)(ae,{tile:n});switch(i){case M:t=U;break;case P:t=A;break;case R:t=B;break;case L:t=J}switch(n.tokenType){case x:c+=" connect-dwarf";break;case y:c+=" connect-mage";break;case k:c+=" connect-barbarian";break;case w:c+=" connect-elf";break;default:throw new Error("Unknown token type")}return Object(ee.jsx)("div",{className:c,children:Object(ee.jsx)("img",{src:t,className:"tile-image",alt:""})})},ce=n.p+"static/media/green-portal.e3d54e5f.png",ie=n.p+"static/media/orange-portal.e0a89eb5.png",oe=n.p+"static/media/yellow-portal.f832ee4b.png",se=n.p+"static/media/purple-portal.f9f584fe.png",le=function(e){var t,n=e.tile,a=(e.gameState,e.selectedPortal);switch(n.tokenType){case x:t=ie;break;case y:t=se;break;case k:t=oe;break;case w:t=ce;break;default:throw new Error("Unknown token type")}var r=!!a&&a.coord.toString()===n.coord.toString();return Object(ee.jsxs)("div",{className:"tile-portal",children:[r?Object(ee.jsx)("div",{className:"portal-indicator"}):"",Object(ee.jsx)("img",{src:t,className:"tile-image",alt:""})]})},ue=n.p+"static/media/s1.cd3f2f2d.png",de=function(e){var t=e.tile,n=e.gameState,r=Object(a.useState)(null),c=Object(o.a)(r,2),i=c[0],s=c[1],l=Object(a.useRef)(null),u=Object(a.useContext)(d);Object(a.useEffect)((function(){var e=u;function n(){var e=K(l,u);e&&(e.tokenType=t.tokenType),s(e)}return e.current.addEventListener("scroll",n),n(),function(){e.current.removeEventListener("scroll",n)}}),[u]);var h="tile-exit",p=ue;switch(t.tokenType){case x:h+=" exit-dwarf";break;case y:h+=" exit-mage";break;case k:h+=" exit-barbarian";break;case w:h+=" exit-elf";break;default:throw new Error("Unknown token type")}var m={};return n!==T&&n!==I&&(m.opacity="40%"),Object(ee.jsxs)("div",{ref:l,className:h,style:m,children:[Object(ee.jsx)("img",{src:p,className:"tile-image",alt:""}),null!==i&&n===T?Object(ee.jsx)(te,{indicatorInfo:i,indicatorImg:p}):""]})},he=n.p+"static/media/rock.3d4d808c.png",pe=function(){var e=he;return"tile-wall",Object(ee.jsx)("div",{className:"tile-wall",children:Object(ee.jsx)("img",{src:e,className:"tile-image",alt:""})})},me=function(){return Object(ee.jsx)("div",{className:"tile-unknown"})},be=function(e){var t,n=e.tile,a=e.getTileDirection,r=e.selectedPortal,c=e.gameState;switch(n.type){case b:t=Object(ee.jsx)(de,{tile:n,gameState:c});break;case j:t=Object(ee.jsx)(pe,{});break;case p:t=Object(ee.jsx)(me,{});break;case f:t=Object(ee.jsx)(re,{tile:n,gameState:c,getTileDirection:a});break;case g:t=Object(ee.jsx)(le,{selectedPortal:r,tile:n,gameState:c});break;case m:t=Object(ee.jsx)(ae,{tile:n,gameState:c});break;default:throw new Error("Invalid tile type")}var i;return Object(ee.jsx)("div",{className:"tile-container",style:(i=n.coord,{gridColumnStart:"".concat(i.x+1),gridRowStart:"".concat(i.y+1)}),children:t})},je=n.p+"static/media/dwarf_right.3de0ca4b.png",fe=n.p+"static/media/warrior2.a0cb9f8d.png",ge=n.p+"static/media/elf_bow.93f90f79.png",ve=n.p+"static/media/mage.23ebe66e.png",Oe=function(e){var t,n,r=e.token,c=e.onTokenSelected,i=Object(a.useState)(null),s=Object(o.a)(i,2),l=s[0],u=s[1],h=Object(a.useRef)(null),p=Object(a.useContext)(d);if(Object(a.useEffect)((function(){var e=p;function t(){var e=K(h,p);e&&r&&(e.tokenType=r.type,r.type===x&&(e.imgScale="60%")),u(e)}return e.current.addEventListener("scroll",t),t(),function(){e.current.removeEventListener("scroll",t)}}),[p]),!r||r.escaped)return"";switch(0!==r.selections.length?t="token-selected":0===r.selections.length&&(t="token"),r.type){case x:n=je,t+=" token-dwarf";break;case w:n=ge,t+=" token-elf";break;case k:n=fe,t+=" token-barbarian";break;case y:n=ve,t+=" token-mage";break;default:throw new Error("Unknown token type")}var m;return Object(ee.jsxs)("div",{ref:h,className:t,style:(m=r.coord,{gridColumnStart:"".concat(m.x+1),gridRowStart:"".concat(m.y+1)}),onClick:function(){r&&c(r)},children:[Object(ee.jsx)("img",{src:n,alt:"token"}),null!==l?Object(ee.jsx)(te,{indicatorInfo:l,indicatorImg:n}):""]})},xe=n.p+"static/media/escalator_down.03b0327b.png",ye=n.p+"static/media/escalator_up.671e7897.png",ke=0,we=1,Se=function(){function e(t,n,a){Object(h.a)(this,e),this.id=t,this.startCoord=n,this.endCoord=a}return Object(O.a)(e,[{key:"getMinX",value:function(){return Math.min(this.startCoord.x,this.endCoord.x)}},{key:"getMinY",value:function(){return Math.min(this.startCoord.y,this.endCoord.y)}},{key:"getRowSpan",value:function(){return Math.abs(this.startCoord.y-this.endCoord.y)+1}},{key:"getColSpan",value:function(){return Math.abs(this.startCoord.x-this.endCoord.x)+1}},{key:"getOrientation",value:function(){var e=this.getMinX(),t=this.getMinY();return e===this.startCoord.x&&t===this.startCoord.y||e===this.endCoord.x&&t===this.endCoord.y?ke:we}}]),e}(),Ce=function(e){var t,n=e.escalator,a=(e.onEscalate,n.getMinY()+1),r=n.getMinX()+1;switch(n.getOrientation()){case ke:t=xe;break;case we:t=ye;break;default:throw new Error("Invalid Orientation")}var c={gridRow:"".concat(a," / span ").concat(n.getRowSpan()),gridColumn:"".concat(r," / span ").concat(n.getColSpan())};return Object(ee.jsx)("div",{className:"escalator",style:c,children:Object(ee.jsx)("img",{className:"escalator-img",src:t,alt:"escalator"})})},Ne=function(e){var t=e.wall,n={gridRow:"".concat(t.getStartRow()," / span ").concat(t.getRowSpan()),gridColumn:"".concat(t.getStartCol()," / span ").concat(t.getColSpan()),zIndex:1};return t.isHorizontal()?(n.borderTop="10px solid #000000",n.height="0px"):(n.borderLeft="10px solid #000000",n.width="0px"),Object(ee.jsx)("div",{className:"wall",style:n})},Te=function(e){var t=e.gameState,n=e.board,r=e.tokens,c=e.escalators,i=e.walls,s=e.gameService,l=Object(a.useRef)(null),u=Object(a.useState)(null),h=Object(o.a)(u,2),p=h[0],m=h[1];Object(a.useEffect)((function(){l.current.focus()}),[]);var b=n.getHeight(),j=n.getWidth(),f=function(e){if(l.current){var t=l.current.getBoundingClientRect(),n=64*e.x,a=64*e.y,r=n-t.width/2+32,c={top:a-t.height/2+32,left:r,behavior:"smooth"};l.current.scrollTo(c)}},v=function(e){s.send(JSON.stringify({type:"SELECTED",selected:e.id}))},O=function(e){return n.getDirection(e)},x={overflow:"auto",display:"grid",gridTemplateColumns:"repeat(".concat(j,", 64px)"),gridTemplateRows:"repeat(".concat(b,", 64px)"),gap:"0px"};return Object(ee.jsx)(d.Provider,{value:l,children:Object(ee.jsxs)("div",{className:"game-board",ref:l,style:x,onKeyDown:function(e){"s"===e.key.toLowerCase()?s.moveDown():"w"===e.key.toLowerCase()?s.moveUp():"a"===e.key.toLowerCase()?s.moveLeft():"d"===e.key.toLowerCase()&&s.moveRight()},onKeyUp:function(e){var t=!1;if("q"===e.key.toLowerCase()){var a=r.find((function(e){return e.isMySelection()})),c=r.filter((function(e){return!e.escaped}));if(!a||a.escaped){var i=c[0];f(i.coord),s.select(i.id)}else{var o=c.indexOf(a),l=c[(o+1)%c.length];f(l.coord),s.select(l.id)}}else if("e"===e.key.toLowerCase()){var u=r.find((function(e){return e.isMySelection()}));if(u){var d=n.getTile(u.coord);d.type===g?(t=!0,n.portalSelector.handle(u,d,f)):s.escalate()}}else if("Enter"===e.key){if(!n.portalSelector.isActive())return;t=!0;var h=n.portalSelector.select();s.teleport(h.coord)}t||n.portalSelector.cancel();var p=n.portalSelector.getSelectedPortal();m(p)},tabIndex:0,children:[n.grid.map((function(e,n){return e.map((function(e,n){return Object(ee.jsx)(be,{selectedPortal:p,tile:e,getTileDirection:O,gameState:t},e.coord.toString())}))})),c.map((function(e){return Object(ee.jsx)(Ce,{escalator:e})})),r.map((function(e){return Object(ee.jsx)(Oe,{token:e,onTokenSelected:v})})),i.map((function(e){return Object(ee.jsx)(Ne,{wall:e})}))]})})},Ee=n(12),Ie=function(){},Me=function(){var e;(e=console).log.apply(e,arguments)},Pe=function(){var e;(e=console).error.apply(e,arguments)},Re=function(){function e(t,n){var a=this;Object(h.a)(this,e),this.setMovements=function(e){a.allowedMovements=e},this.sendBasicCommand=function(e){a.send(JSON.stringify({type:e}))},this.reset=function(){a.sendBasicCommand("RESET")},this.moveRight=function(){a.sendMovement("RIGHT")},this.moveLeft=function(){a.sendMovement("LEFT")},this.moveDown=function(){a.sendMovement("DOWN")},this.moveUp=function(){a.sendMovement("UP")},this.doSomething=function(e){a.send(JSON.stringify({type:"DO-SOMETHING",player:e}))},this.teleport=function(e){a.send(JSON.stringify({type:"TELEPORT",coord:e}))},this.escalate=function(e){a.send(JSON.stringify({type:"ESCALATE",id:e}))},this.handlers=[],this.gameId=t,this.playerName=n,this.allowedMovements=[]}return Object(O.a)(e,[{key:"addHandler",value:function(e){this.handlers=this.handlers.filter((function(t){return t.id!==e.id})),this.handlers.push(e)}},{key:"connect",value:function(){var e=this;return new Promise((function(t,n){var a="wss://"+window.location.host+"?playerName=".concat(e.playerName);e.connection=new WebSocket(a),Ie("Connecting to:"+a),e.connection.onopen=function(){t()},e.connection.onerror=function(e){Pe(e),Pe("Sorry, but there's some problem with your connection or the server is down."),n(e)},e.connection.onmessage=function(t){try{var n=JSON.parse(t.data)}catch(c){return void Pe("Invalid JSON: ",t.data)}if(n.gameId&&n.gameId!==e.gameId)Me("Sent message for different game");else{var a,r=Object(Ee.a)(e.handlers);try{for(r.s();!(a=r.n()).done;){a.value.handle(n)}}catch(i){r.e(i)}finally{r.f()}}},setInterval((function(){1!==e.connection.readyState&&Pe("Error missing connection")}),3e3)}))}},{key:"getInitialUpdate",value:function(){this.sendBasicCommand("INITIAL")}},{key:"send",value:function(e){var t=JSON.parse(e);t.gameId=this.gameId;var n=JSON.stringify(t);Ie("SEND: "+n),this.connection.send(n)}},{key:"select",value:function(e){this.send(JSON.stringify({type:"SELECTED",selected:e}))}},{key:"sendMovement",value:function(e){this.allowedMovements.includes(e)&&this.sendBasicCommand(e)}}]),e}(),Le=function(){function e(t,n){Object(h.a)(this,e),this.x=t,this.y=n}return Object(O.a)(e,[{key:"toString",value:function(){return"(".concat(this.x,", ").concat(this.y,")")}}]),e}(),De=function(){function e(t,n){Object(h.a)(this,e),this.startCoord=t,this.endCoord=n}return Object(O.a)(e,[{key:"getStartRow",value:function(){return Math.min(this.startCoord.y,this.endCoord.y)+1}},{key:"getStartCol",value:function(){return Math.min(this.startCoord.x,this.endCoord.x)+1}},{key:"getRowSpan",value:function(){return Math.max(1,Math.abs(this.startCoord.y-this.endCoord.y))}},{key:"getColSpan",value:function(){return Math.max(1,Math.abs(this.startCoord.x-this.endCoord.x))}},{key:"isHorizontal",value:function(){return this.startCoord.y===this.endCoord.y}}]),e}(),Ue=function(){function e(t,n){Object(h.a)(this,e),this.selectorName=t,this.isSelf=n}return Object(O.a)(e,[{key:"getInitials",value:function(){return this.selectorName.split(" ").map((function(e){return e[0]})).join("")}}]),e}(),Ae=0,Be=1,Je=function(){function e(t){Object(h.a)(this,e),this.resetSelection(),this.portals=t}return Object(O.a)(e,[{key:"resetSelection",value:function(){this.state=Ae,this.selectedIndex=null,this.selectablePortals=[]}},{key:"isActive",value:function(){return this.state!==Ae}},{key:"handle",value:function(e,t,n){if(e.type===t.tokenType){if(this.state===Ae)this.selectedIndex=0,this.selectablePortals=this.portals.filter((function(n){return n.tokenType===e.type&&n!==t})),this.state=Be;else{if(this.state!==Be)throw new Error("Cannot handle that state yet");this.selectedIndex=(this.selectedIndex+1)%this.selectablePortals.length}if(this.selectablePortals.length)n(this.selectablePortals[this.selectedIndex].coord)}}},{key:"getSelectedPortal",value:function(){return null!=this.selectedIndex&&this.selectablePortals.length?this.selectablePortals[this.selectedIndex]:null}},{key:"select",value:function(){if(this.state===Ae)throw new Error("Cannot choose selection while not selecting");if(this.state===Be){var e=this.selectablePortals[this.selectedIndex];return this.resetSelection(),e}throw new Error("Cannot handle that state yet")}},{key:"cancel",value:function(){this.state===Be&&this.resetSelection()}}]),e}(),We=function(){function e(t){Object(h.a)(this,e),this.grid=t,this.portalSelector=new Je(this.getPortals())}return Object(O.a)(e,[{key:"getHeight",value:function(){return this.grid.length}},{key:"getWidth",value:function(){return 0===this.grid.length?0:this.grid[0].length}},{key:"getTile",value:function(e){return e.y<0||e.y>=this.grid.length||e.x<0||e.x>=this.grid[0].length?null:this.grid[e.y][e.x]}},{key:"getPortals",value:function(){return this.grid.flatMap((function(e){return e.filter((function(e){return e.type===g}))}))}},{key:"getWeaponTiles",value:function(){return this.grid.flatMap((function(e){return e.filter((function(e){return e.item&&e.item.type===_}))}))}},{key:"getDirection",value:function(e){if(0===this.grid.length)return D;var t=this.getTile(new Le(e.coord.x-1,e.coord.y)),n=this.getTile(new Le(e.coord.x+1,e.coord.y)),a=this.getTile(new Le(e.coord.x,e.coord.y-1)),r=this.getTile(new Le(e.coord.x,e.coord.y+1)),c=0===e.coord.x,i=e.coord.x===this.grid[0].length-1,o=0===e.coord.y,s=e.coord.y===this.grid.length-1;return c||t&&t.type===p?R:i||n&&n.type===p?L:o||a&&a.type===p?M:s||r&&r.type===p?P:D}}]),e}(),He=n.p+"static/media/staircase.43f64a57.png",ze=n.p+"static/media/selection.bd6de74f.png",Ge=n.p+"static/media/portal2.54f430bb.png",_e=function(e){var t,n,a=e.move,r=e.isSelf;return"LEFT"===a?(t=B,n="A"):"RIGHT"===a?(t=J,n="D"):"UP"===a?(t=U,n="W"):"DOWN"===a?(t=A,n="S"):"ESCALATE"===a?(t=He,n="E"):"PORTAL"===a?(t=Ge,n="E"):"SELECT"===a?(t=ze,n="Q"):console.log("Fail, move: "+a),Object(ee.jsxs)("div",{className:"move-icon",children:[Object(ee.jsx)("img",{src:t,alt:"move"}),r?Object(ee.jsx)("span",{children:n}):""]})},Fe=function(e){var t=e.playerName,n=e.allowedMoves,a=e.doSomething;return Object(ee.jsx)("div",{className:"player-other",children:Object(ee.jsxs)("div",{className:"player-bar",children:[Object(ee.jsx)("label",{children:t}),n.map((function(e){return Object(ee.jsx)(_e,{move:e,isSelf:!1},e)})),Object(ee.jsx)("button",{className:"doSomethingButton",onClick:function(e){a(t)},children:"!"})]})})},Xe=function(e){var t=e.otherPlayers,n=e.doSomething;return Object(ee.jsxs)("div",{children:[Object(ee.jsx)("h2",{hidden:!t.length,children:"Other Players"}),t.map((function(e){return Object(ee.jsx)(Fe,{playerName:e.playerName,allowedMoves:e.moves,isSelf:!1,doSomething:n},e.playerName)}))]})},Ye=n.p+"static/media/sound.886db3ed.png",Ke=function(){return Object(ee.jsx)("div",{className:"talk-icon",children:Object(ee.jsx)("img",{src:Ye,alt:"can-talk"})})},Qe=function(e){var t=e.playerName,n=e.allowedMoves,a=["SELECT","ESCALATE","PORTAL"].concat(n);return Object(ee.jsxs)("div",{className:"player-self",children:[Object(ee.jsx)("span",{id:"mainPlayer",children:t}),Object(ee.jsx)("h2",{children:"Moves"}),Object(ee.jsx)("div",{className:"player-moves",children:a.map((function(e){return Object(ee.jsx)(_e,{move:e,isSelf:!0},e)}))})]})},qe=function(e){var t=e.notification;return null===t?null:Object(ee.jsx)("div",{className:t.isGood?"notification":"notification-bad",children:t.message})},Ze=function(e){var t=e.remainingSeconds,n=function(e){var t="00"+e;return t.substr(t.length-2)},a=n(Math.floor(t/60)),r=n(t%60),c=t>10?"timer":"timer-critical";return Object(ee.jsx)("div",{className:c,children:"".concat(a,":").concat(r)})},Ve=function(e){var t=e.weaponType,n=e.occupied,a=$(t),r={backgroundColor:a.color};n&&(r.opacity="30%");return Object(ee.jsx)("div",{className:"toolbar-icon",style:r,children:Object(ee.jsx)("img",{src:a.img,style:{width:"100%"},alt:"toolbar weapon indicator"})})},$e=function(e){var t=e.gameState,n=e.tokens,a=e.board,r=e.remaining,c=e.remainingSeconds,i="";if(null!==t)switch(t){case C:i="Explore the maze! Remaining: "+r;break;case N:i="Steal the weapons!";break;case T:i="Escape the Maze!";break;case E:i="Game Over";break;case I:i="Win!";break;default:throw new Error("Invalid game state")}var o=a.getWeaponTiles(),s=function(e){var t=n.find((function(t){return t.coord.toString()===e.coord.toString()}));return t&&t.type===e.item.tokenType},l=o.map((function(e){return{type:e.item.tokenType,occupied:s(e)}}));return Object(ee.jsxs)("div",{className:"toolbar",children:[Object(ee.jsx)(Ze,{remainingSeconds:c}),i,Object(ee.jsx)("div",{className:"toolbar-icon-container",children:t===N?l.map((function(e){return Object(ee.jsx)(Ve,{occupied:e.occupied,weaponType:e.type},e.type)})):""})]})},et=n(4),tt=function(e){var t=parseInt(e.x),n=parseInt(e.y);return new Le(t,n)},nt=function(e){var t,n=e.item;return n&&(t=new F(n.type,n.tokenType)),new v(tt(e.pos),function(e){switch(e){case 0:return m;case 1:return j;case 2:return b;case 3:return f;case 4:return g;default:return p}}(e.type),e.hasItem,t,e.tokenType)},at=function(e){var t=e.map((function(e){return function(e){return e.map((function(e){return nt(e)}))}(e)}));return new We(t)},rt=function(e,t){return e.tokens.map((function(n,a){return new S(a,tt(n.pos),function(e,t,n){return e.filter((function(e){return e.selection===t})).map((function(e){return new Ue(e.selectedBy,e.selectedBy===n)}))}(e.selections,a,t),n.escaped,n.type)}))};var ct=function(e){var t=e.realPlayerName,n=Object(a.useState)(new We([])),r=Object(o.a)(n,2),c=r[0],i=r[1],s=Object(a.useState)([]),d=Object(o.a)(s,2),h=d[0],p=d[1],m=Object(a.useState)([]),b=Object(o.a)(m,2),j=b[0],f=b[1],g=Object(a.useState)([]),v=Object(o.a)(g,2),O=v[0],x=v[1],y=Object(a.useState)([]),k=Object(o.a)(y,2),w=k[0],S=k[1],C=Object(a.useState)([]),N=Object(o.a)(C,2),T=N[0],M=N[1],P=Object(a.useState)(null),R=Object(o.a)(P,2),L=R[0],D=R[1],U=Object(a.useState)(null),A=Object(o.a)(U,2),B=A[0],J=A[1],W=Object(a.useState)(null),H=Object(o.a)(W,2),z=H[0],G=H[1],_=Object(a.useState)(0),F=Object(o.a)(_,2),X=F[0],Y=F[1],K=Object(a.useState)(null),Q=Object(o.a)(K,2),q=Q[0],Z=Q[1],V=Object(a.useState)(!1),$=Object(o.a)(V,2),te=$[0],ne=$[1],ae=function(){D(null)},re=Object(et.p)().gameId;Object(a.useEffect)((function(){var e=new Re(re,t),n={id:"app-updates",handle:function(n){var a,r;"token-update"===n.type?(x(rt(n.data,t)),ne(n.canTalk)):"board-update"===n.type?(Ie("Board UPDATE"),i(at(n.data.board.tiles)),p(function(e){return e.map((function(e){return new Se(e.id,tt(e.start),tt(e.end))}))}(n.data.board.escalators)),f(function(e){return e.map((function(e){return new De(tt(e.start),tt(e.end))}))}(n.data.board.walls)),x(rt(n.data.tokenData)),Y(n.data.remainingSections),Z(n.data.state),ae()):"win"===n.type?Z(I):"movements"===n.type?(e.setMovements(n.data.movements),S(n.data.movements)):"all-players"===n.type?M(n.data):"do-something"===n.type?(a="".concat(n.data.sender," wants you to do something."),r=!0,D({message:a,isGood:!0}),r&&setTimeout((function(){ae()}),5e3)):"timer-update"===n.type?J(n.data.seconds):"lose"===n.type&&Z(E)}};function a(){return(a=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connect();case 2:e.getInitialUpdate();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.addHandler(n),function(){a.apply(this,arguments)}(),G(e)}),[re]);var ce=T.filter((function(e){return e.playerName!==t}));return Object(ee.jsxs)("div",{className:"App",children:[Object(ee.jsx)(qe,{notification:L}),Object(ee.jsxs)("div",{className:"board-space",children:[Object(ee.jsx)($e,{gameState:q,tokens:O,board:c,remaining:X,remainingSeconds:B}),Object(ee.jsxs)("div",{className:"board-controls",children:[Object(ee.jsx)(Qe,{playerName:t,allowedMoves:w}),ce.length&&te?Object(ee.jsx)(Ke,{}):Object(ee.jsx)(Xe,{doSomething:function(e){z.doSomething(e)},otherPlayers:ce}),Object(ee.jsx)("button",{className:"button",id:"reset-button",onClick:function(e){z.reset()},children:"Reset"})]}),Object(ee.jsx)(Te,{gameState:q,board:c,tokens:O,escalators:h,walls:j,gameService:z})]})]})},it=n(18),ot=n(47);var st=function(e){var t=e.playerName,n=e.setPlayerName,r=Object(et.n)(),c=Object(a.useRef)(null),i=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ot.a.post("/games",{gameId:c.current.value});case 2:t=e.sent,Ie(t.data),n=t.data.gameId,Ie("Game Id response:"+n),r("/game/".concat(n));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r("/tutorial");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=c.current.value,r("/game/".concat(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(ee.jsxs)("div",{className:"menu",children:[Object(ee.jsx)("h1",{className:"gameTitle",children:"Magic Maze"}),Object(ee.jsxs)("div",{className:"menuSelections",children:[Object(ee.jsx)("div",{className:"menuRow",children:Object(ee.jsx)("input",{type:"text",value:t,onChange:function(e){n(e.target.value)},placeholder:"Nickname",className:"inputText"})}),Object(ee.jsx)("div",{className:"menuRow",children:Object(ee.jsx)("input",{type:"text",ref:c,placeholder:"Game Code",className:"inputText"})}),Object(ee.jsxs)("div",{className:"menuRow",children:[Object(ee.jsx)("button",{onClick:o,className:"button",children:"Tutorial"}),Object(ee.jsx)("button",{onClick:i,className:"button",children:"Create"}),Object(ee.jsx)("button",{onClick:s,className:"button",children:"Join"})]})]})]})},lt=n.p+"static/media/moves.65f51140.png",ut=n.p+"static/media/elf.cb4f32eb.png",dt=function(e){var t=e.title,n=e.children;return Object(ee.jsxs)("div",{className:"header-section",children:[Object(ee.jsx)("h1",{className:"header",children:t}),Object(ee.jsx)("div",{className:"section-content",children:n})]})},ht=function(e){var t=e.images;return Object(ee.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:"24px"},children:t.map((function(e,t){return Object(ee.jsx)("div",{style:{display:"flex",width:"64px",height:"64px",justifyContent:"center",alignItems:"center",borderRadius:"8px",backgroundColor:e.backgroundColor},children:Object(ee.jsx)("img",{src:e.path,alt:"grid",style:{maxWidth:"75%",maxHeight:"75%"}})},t)}))})},pt=function(e){var t=e.image,n=e.title;return Object(ee.jsx)("img",{className:"image",src:t.src,style:{width:t.scale,height:t.scale},alt:n})},mt=function(e){var t=e.title,n=e.content,a=e.visualContent;return Object(ee.jsx)("div",{children:Object(ee.jsxs)("div",{className:"subsection-content",children:[Object(ee.jsxs)("div",{className:"subsection-text",children:[Object(ee.jsx)("h3",{children:t}),Object(ee.jsx)("p",{children:n})]}),a]})})},bt=function(e){var t=e.title,n=e.children,a=e.image;return Object(ee.jsxs)("div",{className:"section",children:[Object(ee.jsx)("h2",{className:"section-title",children:t}),Object(ee.jsxs)("div",{className:"content-container",children:[Object(ee.jsx)("div",{className:"section-content",children:n}),a&&Object(ee.jsx)("img",{className:"image",src:a.src,style:{width:a.scale,height:a.scale},alt:t})]})]})},jt=[{path:U,backgroundColor:"orange"},{path:U,backgroundColor:"yellow"},{path:U,backgroundColor:"green"},{path:U,backgroundColor:"purple"}],ft=[{path:ue,backgroundColor:"orange"},{path:ue,backgroundColor:"yellow"},{path:ue,backgroundColor:"green"},{path:ue,backgroundColor:"purple"}],gt=[{path:ie,backgroundColor:"orange"},{path:oe,backgroundColor:"yellow"},{path:ce,backgroundColor:"green"},{path:se,backgroundColor:"purple"}],vt=[{path:Q,backgroundColor:"orange"},{path:q,backgroundColor:"yellow"},{path:Z,backgroundColor:"green"},{path:V,backgroundColor:"purple"}],Ot=[{path:je,backgroundColor:"orange"},{path:fe,backgroundColor:"yellow"},{path:ut,backgroundColor:"green"},{path:ve,backgroundColor:"purple"}],xt=function(){return Object(ee.jsxs)("div",{className:"tutorial-page",children:[Object(ee.jsx)(dt,{title:"Welcome to Magic Maze Online",children:"Play with up to 3 friends to explore the maze, find weapons, steal them, and escape before time runs out."}),Object(ee.jsxs)(bt,{title:"Controls",image:{src:lt,scale:"33%"},children:[Object(ee.jsx)(mt,{title:"Select Characters",content:"Press 'Q' to switch characters or click on a character."}),Object(ee.jsx)(mt,{title:"Basic Movement",content:Object(ee.jsxs)("div",{children:[Object(ee.jsx)("p",{children:"Press 'W' to move Up"}),Object(ee.jsx)("p",{children:"Press 'A' to move Left"}),Object(ee.jsx)("p",{children:"Press 'S' to move Down"}),Object(ee.jsx)("p",{children:"Press 'D' to move Right"})]})}),Object(ee.jsx)(mt,{title:"Stairs",content:"Press 'E' to traverse up or down stairs."}),Object(ee.jsx)(mt,{title:"Portals",content:"Press 'E' to toggle through available portals. Press Enter/Return to teleport to a selected portal."})]}),Object(ee.jsx)(bt,{title:"Communication",children:Object(ee.jsx)("p",{children:"Use voice/video tech like Zoom, or Discord. For a challenge only talk after picking up an hourglass timer."})}),Object(ee.jsxs)(bt,{title:"Gameplay",children:[Object(ee.jsx)(mt,{title:"Color Coding",content:"Each character has tiles or items available only to them, matched by color",visualContent:Object(ee.jsx)(ht,{images:Ot})}),Object(ee.jsx)(mt,{title:"Exploring",content:"Navigate to exploration tiles to reveal new sections.",visualContent:Object(ee.jsx)(ht,{images:jt})}),Object(ee.jsx)(mt,{title:"Weapons",content:"Steal weapons after exploring all sections and standing on weapon tiles.",visualContent:Object(ee.jsx)(ht,{images:vt})}),Object(ee.jsx)(mt,{title:"Escaping",content:"Get to the exit tiles before time runs out.",visualContent:Object(ee.jsx)(ht,{images:ft})}),Object(ee.jsx)(mt,{title:"Teleportation Portals",content:"Teleport to matching colors using portals.",visualContent:Object(ee.jsx)(ht,{images:gt})}),Object(ee.jsx)(mt,{title:"Timers",content:"Pick up hourglass timers to flip the timer.",visualContent:Object(ee.jsx)(pt,{title:"Timers",image:{src:H,scale:"128px"}})})]}),Object(ee.jsx)("div",{className:"conclusion",children:Object(ee.jsx)("p",{children:"Enjoy playing Magic Maze Online with your friends and explore the maze together!"})})]})};var yt=function(e){return e.playerName,e.setPlayerName,Object(ee.jsxs)("div",{className:"tutorial",children:[Object(ee.jsx)("h1",{className:"gameTitle",children:" Magic Maze"}),Object(ee.jsx)("div",{className:"tutorial-content",children:Object(ee.jsx)(xt,{})})]})};var kt=function(){var e=Object(a.useState)(""),t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(ee.jsx)(it.a,{children:Object(ee.jsxs)(et.c,{children:[Object(ee.jsx)(et.a,{path:"/game/:gameId",element:Object(ee.jsx)(ct,{realPlayerName:n})}),Object(ee.jsx)(et.a,{path:"/",element:Object(ee.jsx)(st,{playerName:n,setPlayerName:r})}),Object(ee.jsx)(et.a,{path:"/tutorial",element:Object(ee.jsx)(yt,{})})]})})};i.a.render(Object(ee.jsx)(r.a.StrictMode,{}),document.getElementById("root")),i.a.render(Object(ee.jsx)(r.a.StrictMode,{children:Object(ee.jsx)(kt,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.a0179563.chunk.js.map