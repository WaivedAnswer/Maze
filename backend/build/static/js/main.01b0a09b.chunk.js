(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var c=n(1),o=n.n(c),i=n(7),r=n.n(i),s=(n(14),n(2)),a=(n(15),n(3)),l=-1,u=1,d=2,j=3,f=4,b=function e(t,n,c){Object(a.a)(this,e),this.coord=t,this.type=n,this.hasItem=c},h=n.p+"static/media/token-none.91062c4c.png",O=n.p+"static/media/token-selected.59573fc5.png",m=n(0),p=function(e){var t,n=e.token,c=e.onTokenSelected;if(!n)return"";n.selectedBy?t=O:n.selectedBy||(t=h);return Object(m.jsx)("div",{className:"token",onClick:function(){n&&c(n)},children:Object(m.jsx)("img",{src:t,alt:"token"})})},y=n.p+"static/media/coins.c9fa3f57.png",v=function(){return Object(m.jsx)("div",{className:"token",children:Object(m.jsx)("img",{src:y,alt:"token"})})},x=function(e){var t,n=e.token,c=e.onTokenSelected,o=e.tile,i=o.type;return t=i===d?"tile-exit":i===j?"tile-wall":i===l?"tile-unknown":i===f?"tile-connect":"tile",Object(m.jsxs)("div",{className:t,children:[Object(m.jsx)(p,{token:n,onTokenSelected:c}),o.hasItem?Object(m.jsx)(v,{}):null]})},S=n(8),g="wss://"+window.location.host,k=new WebSocket(g);k.onopen=function(){console.log("Opened!")};var N=[],w=[];k.onerror=function(e){console.log("Sorry, but there's some problem with your connection or the server is down.")},k.onmessage=function(e){try{var t=JSON.parse(e.data)}catch(o){return void console.log("Invalid JSON: ",e.data)}var n,c=Object(S.a)(N);try{for(c.s();!(n=c.n()).done;){n.value.handle(t)}}catch(i){c.e(i)}finally{c.f()}},setInterval((function(){1!==k.readyState&&console.log("Error missing connection")}),3e3);var I=function(e){k.send(e)},T=function(e){I(JSON.stringify({type:e}))},E=function(e){w.includes(e)&&T(e)},J=I,M=function(){E("RIGHT")},B=function(){E("LEFT")},D=function(){E("DOWN")},C=function(){E("UP")},G=function(e){w=e},P=function(){T("RESET")},R=function(e){I(JSON.stringify({type:"DO-SOMETHING",player:e}))},H=function(e){(N=N.filter((function(t){return t.id!==e.id}))).push(e)},L=n(6),W=n.n(L),Y=function(e){var t=e.grid,n=e.tokens,c=function(e){J(JSON.stringify({type:"SELECTED",selected:e.id}))};return Object(m.jsx)("div",{className:"game-board",onKeyPress:function(e){"s"===e.key?D():"w"===e.key?C():"a"===e.key?B():"d"===e.key&&M()},tabIndex:0,children:Object(m.jsx)("table",{children:Object(m.jsx)("tbody",{children:t.map((function(e,t){return Object(m.jsx)("tr",{children:e.map((function(e,t){return Object(m.jsx)("td",{children:Object(m.jsx)(x,{tile:e,type:e.type,token:(o=e.coord,n.find((function(e){return W()(e.coord,o)}))),onTokenSelected:c})},e.coord.toString());var o}))},t)}))})})})},A=n(9),F=function(){function e(t,n){Object(a.a)(this,e),this.x=t,this.y=n}return Object(A.a)(e,[{key:"toString",value:function(){return"(".concat(this.x,", ").concat(this.y,")")}}]),e}(),K=function e(t,n,c){Object(a.a)(this,e),this.id=t,this.coord=n,this.selectedBy=c},U=function(e){var t=e.moves,n=e.isSelf,c="Moves:";return Object(m.jsxs)("div",{children:[n?Object(m.jsx)("h2",{children:c}):Object(m.jsx)("h3",{children:c}),Object(m.jsx)("ul",{children:t.map((function(e){return Object(m.jsx)("li",{children:e},e)}))})]})},q=function(e){var t=e.playerName,n=e.allowedMoves,c=e.isSelf,o=e.doSomething;return Object(m.jsxs)("div",{className:c?"player-self":"player-other",children:[Object(m.jsxs)("div",{className:"player-bar",children:[Object(m.jsx)("label",{children:t}),c?"":Object(m.jsx)("button",{onClick:function(e){o(t)},children:"Do Something!"})]}),Object(m.jsx)(U,{moves:n,isSelf:c})]})},z=function(e){var t=e.notification;return null===t?null:Object(m.jsx)("div",{className:t.isGood?"notification":"notification-bad",children:t.message})},Q=function(e){var t=e.remainingSeconds;if(!t)return"";var n=function(e){var t="00"+e;return t.substr(t.length-2)},c=n(Math.floor(t/60)),o=n(t%60),i=t>10?"timer":"timer-critical";return Object(m.jsx)("div",{className:i,children:"".concat(c,":").concat(o)})},V=function(e){var t=parseInt(e.x),n=parseInt(e.y);return new F(t,n)},X=function(e){return e.map((function(e){return new b(V(e.pos),function(e){switch(e){case 0:return u;case 1:return j;case 2:return d;case 3:return f;default:return l}}(e.type),e.hasItem)}))},Z=function(e){return e.tokens.map((function(t,n){return new K(n,V(t),function(e,t){var n=e.find((function(e){return e.selection===t}));return n?n.selectedBy.split(" ").map((function(e){return e[0]})).join(""):null}(e.selections,n))}))};var $=function(){var e=Object(c.useState)([[]]),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(c.useState)([]),r=Object(s.a)(i,2),a=r[0],l=r[1],u=Object(c.useState)([]),d=Object(s.a)(u,2),j=d[0],f=d[1],b=Object(c.useState)(""),h=Object(s.a)(b,2),O=h[0],p=h[1],y=Object(c.useState)([]),v=Object(s.a)(y,2),x=v[0],S=v[1],g=Object(c.useState)(null),k=Object(s.a)(g,2),N=k[0],w=k[1],I=Object(c.useState)(null),T=Object(s.a)(I,2),E=T[0],J=T[1],M=function(){w(null)},B=function(e,t,n){w({message:e,isGood:n}),t&&setTimeout((function(){M()}),5e3)};H({id:"app-updates",handle:function(e){"token-update"===e.type?l(Z(e.data)):"board-update"===e.type?(o(e.data.board.tiles.map((function(e){return X(e)}))),l(Z(e.data.tokenData)),M()):"win"===e.type?B("You have won the game!",!1,!0):"movements"===e.type?(G(e.data.movements),f(e.data.movements)):"name"===e.type?p(e.data.name):"all-players"===e.type?S(e.data.filter((function(e){return e.playerName!==O}))):"do-something"===e.type?B("".concat(e.data.sender," wants you to do something."),!0,!0):"timer-update"===e.type?J(e.data.seconds):"lose"===e.type&&B("You have lost the game..",!1,!1)}});var D=function(e){R(e)};return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(z,{notification:N}),Object(m.jsxs)("div",{className:"board-space",children:[Object(m.jsxs)("div",{className:"board-controls",children:[Object(m.jsx)(Q,{remainingSeconds:E}),Object(m.jsx)("br",{}),Object(m.jsx)(q,{playerName:O,allowedMoves:j,isSelf:!0}),Object(m.jsx)("br",{}),Object(m.jsx)("h2",{hidden:!x.length,children:"Other Players:"}),x.map((function(e){return Object(m.jsx)(q,{playerName:e.playerName,allowedMoves:e.moves,isSelf:!1,doSomething:D},e.playerName)})),Object(m.jsx)("button",{onClick:function(e){P()},children:"Reset"})]}),Object(m.jsx)(Y,{grid:n,tokens:a})]})]})};r.a.render(Object(m.jsx)(o.a.StrictMode,{children:Object(m.jsx)($,{})}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.01b0a09b.chunk.js.map