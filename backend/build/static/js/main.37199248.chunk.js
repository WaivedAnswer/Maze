(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{20:function(e,t,n){},21:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var o=n(2),c=n.n(o),r=n(10),i=n.n(r),a=(n(20),n(5)),s=(n(21),n(11)),l=n.n(s),d=n(4),u=1,f=2,j=3,h=function e(t,n){Object(d.a)(this,e),this.coord=t,this.type=n},b=n(0),p=function(e){var t,n=e.token,o=e.type,c=e.onTokenSelected;t=n&&n.isSelected?"token-selected":n&&!n.isSelected?"token":o===f?"tile-exit":o===j?"tile-wall":"tile";return Object(b.jsx)("div",{className:t,onClick:function(){n&&c(n)}})},O=n(14),v="wss://"+window.location.host,y=new WebSocket(v);y.onopen=function(){console.log("Opened!")};var m=[],x=[];y.onerror=function(e){console.log("Sorry, but there's some problem with your connection or the server is down.")},y.onmessage=function(e){try{var t=JSON.parse(e.data)}catch(c){return void console.log("Invalid JSON: ",e.data)}var n,o=Object(O.a)(m);try{for(o.s();!(n=o.n()).done;){n.value.handle(t)}}catch(r){o.e(r)}finally{o.f()}},setInterval((function(){1!==y.readyState&&console.log("Error missing connection")}),3e3);var S=function(e){y.send(JSON.stringify({type:e}))},w=function(e){x.includes(e)&&S(e)},g=function(e){y.send(e)},k=function(){w("RIGHT")},N=function(){w("LEFT")},E=function(){w("DOWN")},I=function(){w("UP")},J=function(e){x=e},M=function(){S("RESET")},T=function(e){(m=m.filter((function(t){return t.id!==e.id}))).push(e)},C=n(6),P=n.n(C),R=function(e){var t=e.grid,n=e.tokens,o=function(e){g(JSON.stringify({type:"SELECTED",selected:e.id}))};return Object(b.jsx)("div",{className:"game-board",onKeyPress:function(e){"s"===e.key?E():"w"===e.key?I():"a"===e.key?N():"d"===e.key&&k()},tabIndex:0,children:Object(b.jsx)(l.a,{width:600/t.length,gap:0,children:t.map((function(e){return e.map((function(e){return Object(b.jsx)(p,{type:e.type,token:(t=e.coord,n.filter((function(e){return P()(e.coord,t)}))[0]),onTokenSelected:o},e.coord.toString());var t}))}))})})},D=n(15),L=function(){function e(t,n){Object(d.a)(this,e),this.x=t,this.y=n}return Object(D.a)(e,[{key:"toString",value:function(){return"(".concat(this.x,", ").concat(this.y,")")}}]),e}(),W=function e(t,n,o){Object(d.a)(this,e),this.id=t,this.coord=n,this.isSelected=o},A=function(e){var t=e.moves,n=e.isSelf,o="Moves:";return Object(b.jsxs)("div",{children:[n?Object(b.jsx)("h2",{children:o}):Object(b.jsx)("h3",{children:o}),Object(b.jsx)("ul",{children:t.map((function(e){return Object(b.jsx)("li",{children:e},e)}))})]})},B=function(e){var t=e.playerName,n=e.allowedMoves,o=e.isSelf,c=o?"ME:":t;return Object(b.jsxs)("div",{className:o?"player-self":"player-other",children:[o?"":Object(b.jsx)("label",{children:c}),Object(b.jsx)(A,{moves:n,isSelf:o})]})},F=function(e){var t=parseInt(e.x),n=parseInt(e.y);return new L(t,n)},G=function(e){return e.tokens.map((function(t,n){return new W(n,F(t),e.selected===n)}))};var H=function(){var e=Object(o.useState)([[]]),t=Object(a.a)(e,2),n=t[0],c=t[1],r=Object(o.useState)([]),i=Object(a.a)(r,2),s=i[0],l=i[1],d=Object(o.useState)([]),p=Object(a.a)(d,2),O=p[0],v=p[1],y=Object(o.useState)(""),m=Object(a.a)(y,2),x=m[0],S=m[1],w=Object(o.useState)([]),g=Object(a.a)(w,2),k=g[0],N=g[1],E={id:"app-updates",handle:function(e){"selected-id"===e.type?(console.log(e),l(G(e.data))):"board-update"===e.type?(c(function(e){for(var t=[],n=F(e.exit),o=e.board.walls.map((function(e){return F(e)})),c=0;c<e.height;c++){for(var r=[],i=function(e){var t=new L(e,c),i=void 0;i=P()(n,t)?f:o.some((function(e){return P()(e,t)}))?j:u,r.push(new h(t,i))},a=0;a<e.width;a++)i(a);t.push(r)}return t}(e.data)),l(G(e.data))):"win"===e.type?alert("You have won the game!"):"movements"===e.type?(J(e.data.movements),v(e.data.movements)):"name"===e.type?S(e.data.name):"all-players"===e.type&&N(e.data.filter((function(e){return e.playerName!==x})))}};return console.log(k),T(E),Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)("div",{className:"board-space",children:[Object(b.jsxs)("div",{className:"board-controls",children:[Object(b.jsx)(B,{playerName:x,allowedMoves:O,isSelf:!0}),Object(b.jsx)("br",{}),Object(b.jsx)("h2",{hidden:!k.length,children:"Other Players:"}),k.map((function(e){return Object(b.jsx)(B,{playerName:e.playerName,allowedMoves:e.moves,isSelf:!1},e.playerName)})),Object(b.jsx)("button",{onClick:function(e){M()},children:"Reset"})]}),Object(b.jsx)(R,{grid:n,tokens:s})]})})};i.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(H,{})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.37199248.chunk.js.map