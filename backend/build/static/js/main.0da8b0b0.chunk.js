(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{37:function(e,t,n){},39:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(24),i=n.n(o),c=(n(37),n(5)),s=n(6),l=n.n(s),u=n(10),d=(n(39),r.a.createContext()),h=n(8),p=-1,m=1,b=2,f=3,g=4,j=5,y=function e(t,n,a,r,o){Object(h.a)(this,e),this.coord=t,this.type=n,this.hasItem=a,this.item=r,this.tokenType=o},v=n(9),O=1,x=2,w=3,k=4,C=function(){function e(t,n,a,r,o){Object(h.a)(this,e),this.id=t,this.coord=n,this.selections=a,this.escaped=r,this.type=o}return Object(v.a)(e,[{key:"isMySelection",value:function(){return this.selections.find((function(e){return e.isSelf}))}}]),e}(),S=0,N=1,T=2,E=3,I=4,M=0,R=1,L=2,D=3,P=4,A=n.p+"static/media/up.552f859e.png",B=n.p+"static/media/down.40f8ab30.png",J=n.p+"static/media/left.aa0f5ff4.png",U=n.p+"static/media/right.9a984c67.png",W=n.p+"static/media/coins_new.2254d122.png",H=n.p+"static/media/timer.c21cbb42.png",z=0,G=1,Y=2,F=function e(t,n){Object(h.a)(this,e),this.type=t,this.tokenType=n},_=n(16),X=function(e,t){return Object(_.a)(Object(_.a)({},function(e,t){var n=Math.max(e.left,t.left);return n<e.right-t.width?{left:n}:{right:window.innerWidth-e.right}}(e,t)),function(e,t){var n=Math.max(e.top,t.top);return n<e.bottom-t.height?{top:n}:{bottom:window.innerHeight-e.bottom}}(e,t))},K=function(e,t){if(!e.current||!t.current)return null;var n=e.current.getBoundingClientRect(),a=t.current.getBoundingClientRect();if(n.top<=a.bottom&&n.left<=a.right&&n.bottom>=a.top&&n.right>=a.left)return null;var r=a.top-n.bottom,o=n.top-a.bottom,i=a.left-n.right,c=n.left-a.right,s=Math.max(r,o,i,c),l=X(a,n);if(r===s)return Object(_.a)({direction:M},l);if(o===s)return Object(_.a)({direction:R,bottom:window.innerHeight-a.bottom},l);if(c===s)return Object(_.a)({direction:D},l);if(i===s)return Object(_.a)({direction:L},l);throw new Error("No direction specified")},Q=n.p+"static/media/axe2.3337d039.png",q=n.p+"static/media/sword.003d0d39.png",Z=n.p+"static/media/arrows2.6d27d5a7.png",V=n.p+"static/media/potion.dc85f7b3.png",$=function(e){switch(e){case O:return{img:Q,color:"orange"};case w:return{img:q,color:"yellow"};case k:return{img:Z,color:"green"};case x:return{img:V,color:"purple"};default:throw new Error("Invalid token type")}},ee=n(1),te=function(e){var t,n=e.indicatorImg,a=e.indicatorInfo,r={display:"flex",bottom:a.bottom,top:a.top,left:a.left,right:a.right,justifyContent:"center",alignItems:"center"},o={height:a.imgScale,width:a.imgScale},i="offscreen";switch(a.tokenType){case w:i+=" barbarian";break;case O:i+=" dwarf";break;case k:console.log("ELF",n,a.tokenType),i+=" elf";break;case x:console.log("MAGE",n,a.tokenType),i+=" mage"}switch(a.direction){case M:t=A,r.flexDirection="column";break;case R:t=B,r.flexDirection="column-reverse";break;case L:t=J,r.flexDirection="row";break;case D:t=U,r.flexDirection="row-reverse";break;default:throw new Error("Unsupported offscreen direction")}return Object(ee.jsxs)("div",{className:i,style:r,children:[Object(ee.jsx)("img",{src:t,className:"offscreen-direction",alt:"offscreen direction"}),Object(ee.jsx)("img",{src:n,style:o,className:"offscreen-image",alt:"offscreen indicator"})]})},ne=function(e){var t,n=e.item,r=e.gameState,o=Object(a.useState)(null),i=Object(c.a)(o,2),s=i[0],l=i[1],u=Object(a.useRef)(null),h=Object(a.useContext)(d);Object(a.useEffect)((function(){var e=h;function t(){var e=K(u,h);e&&(e.tokenType=n.tokenType),l(e)}return e.current.addEventListener("scroll",t),t(),function(){e.current.removeEventListener("scroll",t)}}),[h]);var p="item",m={},b=!1;switch(n.type){case z:t=W,p+=" coin";break;case G:t=H,p+=" time";break;case Y:var f=$(n.tokenType);t=f.img,p+=" weapon",m.backgroundColor=f.color,r!==N&&(m.opacity="30%"),b=null!==s&&r===N;break;default:throw new Error("Unknown item type: "+JSON.stringify(n))}return Object(ee.jsxs)("div",{ref:u,className:p,style:m,children:[Object(ee.jsx)("img",{src:t,alt:"item"}),b?Object(ee.jsx)(te,{indicatorInfo:s,indicatorImg:t}):""]})},ae=function(e){var t=e.tile,n=e.gameState;return Object(ee.jsx)("div",{className:"tile",children:t.hasItem?Object(ee.jsx)(ne,{item:t.item,gameState:n}):null})},re=function(e){var t,n=e.tile,a=e.getTileDirection,r=e.gameState,o="tile-connect",i=a(n);if(!(i!==P&&r===S))return Object(ee.jsx)(ae,{tile:n});switch(i){case M:t=A;break;case R:t=B;break;case L:t=J;break;case D:t=U}switch(n.tokenType){case O:o+=" connect-dwarf";break;case x:o+=" connect-mage";break;case w:o+=" connect-barbarian";break;case k:o+=" connect-elf";break;default:throw new Error("Unknown token type")}return Object(ee.jsx)("div",{className:o,children:Object(ee.jsx)("img",{src:t,className:"tile-image",alt:""})})},oe=n.p+"static/media/green-portal.e3d54e5f.png",ie=n.p+"static/media/orange-portal.e0a89eb5.png",ce=n.p+"static/media/yellow-portal.f832ee4b.png",se=n.p+"static/media/purple-portal.f9f584fe.png",le=function(e){var t=e.tile,n=e.gameState;if(!(n===S||n===N))return Object(ee.jsx)(ae,{tile:t});var a;switch(t.tokenType){case O:a=ie;break;case x:a=se;break;case w:a=ce;break;case k:a=oe;break;default:throw new Error("Unknown token type")}return Object(ee.jsx)("div",{className:"tile-portal",children:Object(ee.jsx)("img",{src:a,className:"tile-image",alt:""})})},ue=n.p+"static/media/s1.cd3f2f2d.png",de=function(e){var t=e.tile,n=e.gameState,r=Object(a.useState)(null),o=Object(c.a)(r,2),i=o[0],s=o[1],l=Object(a.useRef)(null),u=Object(a.useContext)(d);Object(a.useEffect)((function(){var e=u;function n(){var e=K(l,u);e&&(e.tokenType=t.tokenType),s(e)}return e.current.addEventListener("scroll",n),n(),function(){e.current.removeEventListener("scroll",n)}}),[u]);var h="tile-exit",p=ue;switch(t.tokenType){case O:h+=" exit-dwarf";break;case x:h+=" exit-mage";break;case w:h+=" exit-barbarian";break;case k:h+=" exit-elf";break;default:throw new Error("Unknown token type")}var m={};return n!==T&&n!==I&&(m.opacity="40%"),Object(ee.jsxs)("div",{ref:l,className:h,style:m,children:[Object(ee.jsx)("img",{src:p,className:"tile-image",alt:""}),null!==i&&n===T?Object(ee.jsx)(te,{indicatorInfo:i,indicatorImg:p}):""]})},he=n.p+"static/media/rock.3d4d808c.png",pe=function(){var e=he;return"tile-wall",Object(ee.jsx)("div",{className:"tile-wall",children:Object(ee.jsx)("img",{src:e,className:"tile-image",alt:""})})},me=function(){return Object(ee.jsx)("div",{className:"tile-unknown"})},be=function(e){var t,n=e.tile,a=e.getTileDirection,r=e.gameState;switch(n.type){case b:t=Object(ee.jsx)(de,{tile:n,gameState:r});break;case f:t=Object(ee.jsx)(pe,{});break;case p:t=Object(ee.jsx)(me,{});break;case g:t=Object(ee.jsx)(re,{tile:n,gameState:r,getTileDirection:a});break;case j:t=Object(ee.jsx)(le,{tile:n,gameState:r});break;case m:t=Object(ee.jsx)(ae,{tile:n,gameState:r});break;default:throw new Error("Invalid tile type")}var o;return Object(ee.jsx)("div",{className:"tile-container",style:(o=n.coord,{gridColumnStart:"".concat(o.x+1),gridRowStart:"".concat(o.y+1)}),children:t})},fe=n.p+"static/media/dwarf_right.3de0ca4b.png",ge=n.p+"static/media/warrior2.a0cb9f8d.png",je=n.p+"static/media/elf_bow.93f90f79.png",ye=n.p+"static/media/mage.23ebe66e.png",ve=function(e){var t,n,r=e.token,o=e.onTokenSelected,i=Object(a.useState)(null),s=Object(c.a)(i,2),l=s[0],u=s[1],h=Object(a.useRef)(null),p=Object(a.useContext)(d);if(Object(a.useEffect)((function(){var e=p;function t(){var e=K(h,p);e&&r&&(e.tokenType=r.type,r.type===O&&(e.imgScale="60%")),u(e)}return e.current.addEventListener("scroll",t),t(),function(){e.current.removeEventListener("scroll",t)}}),[p]),!r||r.escaped)return"";switch(0!==r.selections.length?t="token-selected":0===r.selections.length&&(t="token"),r.type){case O:n=fe,t+=" token-dwarf";break;case k:n=je,t+=" token-elf";break;case w:n=ge,t+=" token-barbarian";break;case x:n=ye,t+=" token-mage";break;default:throw new Error("Unknown token type")}var m;return Object(ee.jsxs)("div",{ref:h,className:t,style:(m=r.coord,{gridColumnStart:"".concat(m.x+1),gridRowStart:"".concat(m.y+1)}),onClick:function(){r&&o(r)},children:[Object(ee.jsx)("img",{src:n,alt:"token"}),null!==l?Object(ee.jsx)(te,{indicatorInfo:l,indicatorImg:n}):""]})},Oe=n.p+"static/media/escalator_down.03b0327b.png",xe=n.p+"static/media/escalator_up.671e7897.png",we=0,ke=1,Ce=function(){function e(t,n,a){Object(h.a)(this,e),this.id=t,this.startCoord=n,this.endCoord=a}return Object(v.a)(e,[{key:"getMinX",value:function(){return Math.min(this.startCoord.x,this.endCoord.x)}},{key:"getMinY",value:function(){return Math.min(this.startCoord.y,this.endCoord.y)}},{key:"getRowSpan",value:function(){return Math.abs(this.startCoord.y-this.endCoord.y)+1}},{key:"getColSpan",value:function(){return Math.abs(this.startCoord.x-this.endCoord.x)+1}},{key:"getOrientation",value:function(){var e=this.getMinX(),t=this.getMinY();return e===this.startCoord.x&&t===this.startCoord.y||e===this.endCoord.x&&t===this.endCoord.y?we:ke}}]),e}(),Se=function(e){var t,n=e.escalator,a=(e.onEscalate,n.getMinY()+1),r=n.getMinX()+1;switch(n.getOrientation()){case we:t=Oe;break;case ke:t=xe;break;default:throw new Error("Invalid Orientation")}var o={gridRow:"".concat(a," / span ").concat(n.getRowSpan()),gridColumn:"".concat(r," / span ").concat(n.getColSpan())};return Object(ee.jsx)("div",{className:"escalator",style:o,children:Object(ee.jsx)("img",{className:"escalator-img",src:t,alt:"escalator"})})},Ne=function(e){var t=e.wall,n={gridRow:"".concat(t.getStartRow()," / span ").concat(t.getRowSpan()),gridColumn:"".concat(t.getStartCol()," / span ").concat(t.getColSpan()),zIndex:1};return t.isHorizontal()?(n.borderTop="10px solid #000000",n.height="0px"):(n.borderLeft="10px solid #000000",n.width="0px"),Object(ee.jsx)("div",{className:"wall",style:n})},Te=function(e){var t=e.gameState,n=e.board,r=e.tokens,o=e.escalators,i=e.walls,c=e.gameService,s=Object(a.useRef)(null);Object(a.useEffect)((function(){s.current.focus()}),[]);var l=n.getHeight(),u=n.getWidth(),h=function(e){if(s.current){var t=s.current.getBoundingClientRect(),n=64*e.x,a=64*e.y,r=n-t.width/2+32,o={top:a-t.height/2+32,left:r,behavior:"smooth"};s.current.scrollTo(o)}},p=function(e){c.send(JSON.stringify({type:"SELECTED",selected:e.id}))},m=function(e){return n.getDirection(e)},b={overflow:"auto",display:"grid",gridTemplateColumns:"repeat(".concat(u,", 64px)"),gridTemplateRows:"repeat(".concat(l,", 64px)"),gap:"0px"};return Object(ee.jsx)(d.Provider,{value:s,children:Object(ee.jsxs)("div",{className:"game-board",ref:s,style:b,onKeyDown:function(e){"s"===e.key.toLowerCase()?c.moveDown():"w"===e.key.toLowerCase()?c.moveUp():"a"===e.key.toLowerCase()?c.moveLeft():"d"===e.key.toLowerCase()&&c.moveRight()},onKeyUp:function(e){var t=!1;if("q"===e.key.toLowerCase()){var a=r.find((function(e){return e.isMySelection()})),o=r.filter((function(e){return!e.escaped}));if(!a||a.escaped){var i=o[0];h(i.coord),c.select(i.id)}else{var s=o.indexOf(a),l=o[(s+1)%o.length];h(l.coord),c.select(l.id)}}else if("e"===e.key.toLowerCase()){var u=r.find((function(e){return e.isMySelection()}));if(u){var d=n.getTile(u.coord);d.type===j?(t=!0,n.portalSelector.handle(u,d,h)):c.escalate()}}else if("Enter"===e.key){if(!n.portalSelector.isActive())return;t=!0;var p=n.portalSelector.select();c.teleport(p.coord)}t||n.portalSelector.cancel()},tabIndex:0,children:[n.grid.map((function(e,n){return e.map((function(e,n){return Object(ee.jsx)(be,{tile:e,getTileDirection:m,gameState:t},e.coord.toString())}))})),o.map((function(e){return Object(ee.jsx)(Se,{escalator:e})})),r.map((function(e){return Object(ee.jsx)(ve,{token:e,onTokenSelected:p})})),i.map((function(e){return Object(ee.jsx)(Ne,{wall:e})}))]})})},Ee=n(12),Ie=function(){},Me=function(){var e;(e=console).log.apply(e,arguments)},Re=function(){var e;(e=console).error.apply(e,arguments)},Le=function(){function e(t,n){var a=this;Object(h.a)(this,e),this.setMovements=function(e){a.allowedMovements=e},this.sendBasicCommand=function(e){a.send(JSON.stringify({type:e}))},this.reset=function(){a.sendBasicCommand("RESET")},this.moveRight=function(){a.sendMovement("RIGHT")},this.moveLeft=function(){a.sendMovement("LEFT")},this.moveDown=function(){a.sendMovement("DOWN")},this.moveUp=function(){a.sendMovement("UP")},this.doSomething=function(e){a.send(JSON.stringify({type:"DO-SOMETHING",player:e}))},this.teleport=function(e){a.send(JSON.stringify({type:"TELEPORT",coord:e}))},this.escalate=function(e){a.send(JSON.stringify({type:"ESCALATE",id:e}))},this.handlers=[],this.gameId=t,this.playerName=n,this.allowedMovements=[]}return Object(v.a)(e,[{key:"addHandler",value:function(e){this.handlers=this.handlers.filter((function(t){return t.id!==e.id})),this.handlers.push(e)}},{key:"connect",value:function(){var e=this;return new Promise((function(t,n){var a="wss://"+window.location.host+"?playerName=".concat(e.playerName);e.connection=new WebSocket(a),Ie("Connecting to:"+a),e.connection.onopen=function(){t()},e.connection.onerror=function(e){Re(e),Re("Sorry, but there's some problem with your connection or the server is down."),n(e)},e.connection.onmessage=function(t){try{var n=JSON.parse(t.data)}catch(o){return void Re("Invalid JSON: ",t.data)}if(n.gameId&&n.gameId!==e.gameId)Me("Sent message for different game");else{var a,r=Object(Ee.a)(e.handlers);try{for(r.s();!(a=r.n()).done;){a.value.handle(n)}}catch(i){r.e(i)}finally{r.f()}}},setInterval((function(){1!==e.connection.readyState&&Re("Error missing connection")}),3e3)}))}},{key:"getInitialUpdate",value:function(){this.sendBasicCommand("INITIAL")}},{key:"send",value:function(e){var t=JSON.parse(e);t.gameId=this.gameId;var n=JSON.stringify(t);Ie("SEND: "+n),this.connection.send(n)}},{key:"select",value:function(e){this.send(JSON.stringify({type:"SELECTED",selected:e}))}},{key:"sendMovement",value:function(e){this.allowedMovements.includes(e)&&this.sendBasicCommand(e)}}]),e}(),De=function(){function e(t,n){Object(h.a)(this,e),this.x=t,this.y=n}return Object(v.a)(e,[{key:"toString",value:function(){return"(".concat(this.x,", ").concat(this.y,")")}}]),e}(),Pe=function(){function e(t,n){Object(h.a)(this,e),this.startCoord=t,this.endCoord=n}return Object(v.a)(e,[{key:"getStartRow",value:function(){return Math.min(this.startCoord.y,this.endCoord.y)+1}},{key:"getStartCol",value:function(){return Math.min(this.startCoord.x,this.endCoord.x)+1}},{key:"getRowSpan",value:function(){return Math.max(1,Math.abs(this.startCoord.y-this.endCoord.y))}},{key:"getColSpan",value:function(){return Math.max(1,Math.abs(this.startCoord.x-this.endCoord.x))}},{key:"isHorizontal",value:function(){return this.startCoord.y===this.endCoord.y}}]),e}(),Ae=function(){function e(t,n){Object(h.a)(this,e),this.selectorName=t,this.isSelf=n}return Object(v.a)(e,[{key:"getInitials",value:function(){return this.selectorName.split(" ").map((function(e){return e[0]})).join("")}}]),e}(),Be=0,Je=1,Ue=function(){function e(t){Object(h.a)(this,e),this.resetSelection(),this.portals=t}return Object(v.a)(e,[{key:"resetSelection",value:function(){this.state=Be,this.selectedIndex=null,this.selectablePortals=[]}},{key:"isActive",value:function(){return this.state!==Be}},{key:"handle",value:function(e,t,n){if(e.type===t.tokenType){if(this.state===Be)this.selectedIndex=0,this.selectablePortals=this.portals.filter((function(n){return n.tokenType===e.type&&n!==t})),this.state=Je;else{if(this.state!==Je)throw new Error("Cannot handle that state yet");this.selectedIndex=(this.selectedIndex+1)%this.selectablePortals.length}if(this.selectablePortals.length)n(this.selectablePortals[this.selectedIndex].coord)}}},{key:"select",value:function(){if(this.state===Be)throw new Error("Cannot choose selection while not selecting");if(this.state===Je){var e=this.selectablePortals[this.selectedIndex];return this.resetSelection(),e}throw new Error("Cannot handle that state yet")}},{key:"cancel",value:function(){this.state===Je&&this.resetSelection()}}]),e}(),We=function(){function e(t){Object(h.a)(this,e),this.grid=t,this.portalSelector=new Ue(this.getPortals())}return Object(v.a)(e,[{key:"getHeight",value:function(){return this.grid.length}},{key:"getWidth",value:function(){return 0===this.grid.length?0:this.grid[0].length}},{key:"getTile",value:function(e){return e.y<0||e.y>=this.grid.length||e.x<0||e.x>=this.grid[0].length?null:this.grid[e.y][e.x]}},{key:"getPortals",value:function(){return this.grid.flatMap((function(e){return e.filter((function(e){return e.type===j}))}))}},{key:"getWeaponTiles",value:function(){return this.grid.flatMap((function(e){return e.filter((function(e){return e.item&&e.item.type===Y}))}))}},{key:"getDirection",value:function(e){if(0===this.grid.length)return P;var t=this.getTile(new De(e.coord.x-1,e.coord.y)),n=this.getTile(new De(e.coord.x+1,e.coord.y)),a=this.getTile(new De(e.coord.x,e.coord.y-1)),r=this.getTile(new De(e.coord.x,e.coord.y+1)),o=0===e.coord.x,i=e.coord.x===this.grid[0].length-1,c=0===e.coord.y,s=e.coord.y===this.grid.length-1;return o||t&&t.type===p?L:i||n&&n.type===p?D:c||a&&a.type===p?M:s||r&&r.type===p?R:P}}]),e}(),He=n.p+"static/media/staircase.43f64a57.png",ze=n.p+"static/media/selection.bd6de74f.png",Ge=n.p+"static/media/portal2.54f430bb.png",Ye=function(e){var t,n,a=e.move,r=e.isSelf;return"LEFT"===a?(t=J,n="A"):"RIGHT"===a?(t=U,n="D"):"UP"===a?(t=A,n="W"):"DOWN"===a?(t=B,n="S"):"ESCALATE"===a?(t=He,n="E"):"PORTAL"===a?(t=Ge,n="E"):"SELECT"===a?(t=ze,n="Q"):console.log("Fail, move: "+a),Object(ee.jsxs)("div",{className:"move-icon",children:[Object(ee.jsx)("img",{src:t,alt:"move"}),r?Object(ee.jsx)("span",{children:n}):""]})},Fe=function(e){var t=e.playerName,n=e.allowedMoves,a=e.doSomething;return Object(ee.jsx)("div",{className:"player-other",children:Object(ee.jsxs)("div",{className:"player-bar",children:[Object(ee.jsx)("label",{children:t}),n.map((function(e){return Object(ee.jsx)(Ye,{move:e,isSelf:!1},e)})),Object(ee.jsx)("button",{className:"doSomethingButton",onClick:function(e){a(t)},children:"!"})]})})},_e=function(e){var t=e.playerName,n=e.allowedMoves,a=["SELECT","ESCALATE","PORTAL"].concat(n);return Object(ee.jsxs)("div",{className:"player-self",children:[Object(ee.jsx)("span",{id:"mainPlayer",children:t}),Object(ee.jsx)("h2",{children:"Moves"}),Object(ee.jsx)("div",{className:"player-moves",children:a.map((function(e){return Object(ee.jsx)(Ye,{move:e,isSelf:!0},e)}))})]})},Xe=function(e){var t=e.notification;return null===t?null:Object(ee.jsx)("div",{className:t.isGood?"notification":"notification-bad",children:t.message})},Ke=function(e){var t=e.remainingSeconds,n=function(e){var t="00"+e;return t.substr(t.length-2)},a=n(Math.floor(t/60)),r=n(t%60),o=t>10?"timer":"timer-critical";return Object(ee.jsx)("div",{className:o,children:"".concat(a,":").concat(r)})},Qe=function(e){var t=e.weaponType,n=e.occupied,a=$(t),r={backgroundColor:a.color};n&&(r.opacity="30%");return Object(ee.jsx)("div",{className:"toolbar-icon",style:r,children:Object(ee.jsx)("img",{src:a.img,style:{width:"100%"},alt:"toolbar weapon indicator"})})},qe=function(e){var t=e.gameState,n=e.tokens,a=e.board,r=e.remaining,o=e.remainingSeconds,i="";if(null!==t)switch(t){case S:i="Explore the maze! Remaining: "+r;break;case N:i="Steal the weapons!";break;case T:i="Escape the Maze!";break;case E:i="Game Over";break;case I:i="Win!";break;default:throw new Error("Invalid game state")}var c=a.getWeaponTiles(),s=function(e){var t=n.find((function(t){return t.coord.toString()===e.coord.toString()}));return t&&t.type===e.item.tokenType},l=c.map((function(e){return{type:e.item.tokenType,occupied:s(e)}}));return Object(ee.jsxs)("div",{className:"toolbar",children:[Object(ee.jsx)(Ke,{remainingSeconds:o}),i,Object(ee.jsx)("div",{class:"toolbar-icon-container",children:t===N?l.map((function(e){return Object(ee.jsx)(Qe,{occupied:e.occupied,weaponType:e.type},e.type)})):""})]})},Ze=n(4),Ve=function(e){var t=parseInt(e.x),n=parseInt(e.y);return new De(t,n)},$e=function(e){var t,n=e.item;return n&&(t=new F(n.type,n.tokenType)),new y(Ve(e.pos),function(e){switch(e){case 0:return m;case 1:return f;case 2:return b;case 3:return g;case 4:return j;default:return p}}(e.type),e.hasItem,t,e.tokenType)},et=function(e){var t=e.map((function(e){return function(e){return e.map((function(e){return $e(e)}))}(e)}));return new We(t)},tt=function(e,t){return e.tokens.map((function(n,a){return new C(a,Ve(n.pos),function(e,t,n){return e.filter((function(e){return e.selection===t})).map((function(e){return new Ae(e.selectedBy,e.selectedBy===n)}))}(e.selections,a,t),n.escaped,n.type)}))};var nt=function(e){var t=e.realPlayerName,n=Object(a.useState)(new We([])),r=Object(c.a)(n,2),o=r[0],i=r[1],s=Object(a.useState)([]),d=Object(c.a)(s,2),h=d[0],p=d[1],m=Object(a.useState)([]),b=Object(c.a)(m,2),f=b[0],g=b[1],j=Object(a.useState)([]),y=Object(c.a)(j,2),v=y[0],O=y[1],x=Object(a.useState)([]),w=Object(c.a)(x,2),k=w[0],C=w[1],S=Object(a.useState)([]),N=Object(c.a)(S,2),T=N[0],M=N[1],R=Object(a.useState)(null),L=Object(c.a)(R,2),D=L[0],P=L[1],A=Object(a.useState)(null),B=Object(c.a)(A,2),J=B[0],U=B[1],W=Object(a.useState)(null),H=Object(c.a)(W,2),z=H[0],G=H[1],Y=Object(a.useState)(0),F=Object(c.a)(Y,2),_=F[0],X=F[1],K=Object(a.useState)(null),Q=Object(c.a)(K,2),q=Q[0],Z=Q[1],V=function(){P(null)},$=Object(Ze.p)().gameId;Object(a.useEffect)((function(){var e=new Le($,t),n={id:"app-updates",handle:function(n){var a,r;"token-update"===n.type?O(tt(n.data,t)):"board-update"===n.type?(Ie("Board UPDATE"),i(et(n.data.board.tiles)),p(function(e){return e.map((function(e){return new Ce(e.id,Ve(e.start),Ve(e.end))}))}(n.data.board.escalators)),g(function(e){return e.map((function(e){return new Pe(Ve(e.start),Ve(e.end))}))}(n.data.board.walls)),O(tt(n.data.tokenData)),X(n.data.remainingSections),Z(n.data.state),V()):"win"===n.type?Z(I):"movements"===n.type?(e.setMovements(n.data.movements),C(n.data.movements)):"all-players"===n.type?M(n.data):"do-something"===n.type?(a="".concat(n.data.sender," wants you to do something."),r=!0,P({message:a,isGood:!0}),r&&setTimeout((function(){V()}),5e3)):"timer-update"===n.type?U(n.data.seconds):"lose"===n.type&&Z(E)}};function a(){return(a=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connect();case 2:e.getInitialUpdate();case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}e.addHandler(n),function(){a.apply(this,arguments)}(),G(e)}),[$]);var te=function(e){z.doSomething(e)},ne=T.filter((function(e){return e.playerName!==t}));return Object(ee.jsxs)("div",{className:"App",children:[Object(ee.jsx)(Xe,{notification:D}),Object(ee.jsxs)("div",{className:"board-space",children:[Object(ee.jsx)(qe,{gameState:q,tokens:v,board:o,remaining:_,remainingSeconds:J}),Object(ee.jsxs)("div",{className:"board-controls",children:[Object(ee.jsx)(_e,{playerName:t,allowedMoves:k}),Object(ee.jsx)("h2",{hidden:!ne.length,children:"Other Players:"}),ne.map((function(e){return Object(ee.jsx)(Fe,{playerName:e.playerName,allowedMoves:e.moves,isSelf:!1,doSomething:te},e.playerName)})),Object(ee.jsx)("button",{className:"button",id:"reset-button",onClick:function(e){z.reset()},children:"Reset"})]}),Object(ee.jsx)(Te,{gameState:q,board:o,tokens:v,escalators:h,walls:f,gameService:z})]})]})},at=n(18),rt=n(47);var ot=function(e){var t=e.playerName,n=e.setPlayerName,r=Object(Ze.n)(),o=Object(a.useRef)(null),i=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rt.a.post("/games",{gameId:o.current.value});case 2:t=e.sent,Ie(t.data),n=t.data.gameId,Ie("Game Id response:"+n),r("/game/".concat(n));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r("/tutorial");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.current.value,r("/game/".concat(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(ee.jsxs)("div",{className:"menu",children:[Object(ee.jsx)("h1",{className:"gameTitle",children:"Magic Maze"}),Object(ee.jsxs)("div",{className:"menuSelections",children:[Object(ee.jsx)("div",{className:"menuRow",children:Object(ee.jsx)("input",{type:"text",value:t,onChange:function(e){n(e.target.value)},placeholder:"Nickname",className:"inputText"})}),Object(ee.jsx)("div",{className:"menuRow",children:Object(ee.jsx)("input",{type:"text",ref:o,placeholder:"Game Code",className:"inputText"})}),Object(ee.jsxs)("div",{className:"menuRow",children:[Object(ee.jsx)("button",{onClick:c,className:"button",children:"Tutorial"}),Object(ee.jsx)("button",{onClick:i,className:"button",children:"Create"}),Object(ee.jsx)("button",{onClick:s,className:"button",children:"Join"})]})]})]})},it=n.p+"static/media/moves.65f51140.png",ct=n.p+"static/media/elf.cb4f32eb.png",st=[{path:fe,backgroundColor:"orange"},{path:ge,backgroundColor:"yellow"},{path:ct,backgroundColor:"green"},{path:ye,backgroundColor:"purple"},{path:A,backgroundColor:"orange"},{path:A,backgroundColor:"yellow"},{path:A,backgroundColor:"green"},{path:A,backgroundColor:"purple"},{path:ie,backgroundColor:"orange"},{path:ce,backgroundColor:"yellow"},{path:oe,backgroundColor:"green"},{path:se,backgroundColor:"purple"},{path:Q,backgroundColor:"orange"},{path:q,backgroundColor:"yellow"},{path:Z,backgroundColor:"green"},{path:V,backgroundColor:"purple"},{path:ue,backgroundColor:"orange"},{path:ue,backgroundColor:"yellow"},{path:ue,backgroundColor:"green"},{path:ue,backgroundColor:"purple"}],lt=function(){return Object(ee.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"repeat(5, 1fr)",gap:"10px"},children:st.map((function(e,t){return Object(ee.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"8px",padding:"16px",backgroundColor:e.backgroundColor},children:Object(ee.jsx)("img",{src:e.path,alt:"grid",style:{maxWidth:"100%",maxHeight:"100%"}})},t)}))})},ut=function(e){var t=e.title;return Object(ee.jsx)("h1",{className:"header",children:t})},dt=function(e){var t=e.images;return console.log(t),Object(ee.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:t.map((function(e,t){return Object(ee.jsx)("div",{style:{display:"flex",width:"64px",height:"64px",justifyContent:"center",alignItems:"center",borderRadius:"8px",backgroundColor:e.backgroundColor},children:Object(ee.jsx)("img",{src:e.path,alt:"grid",style:{maxWidth:"75%",maxHeight:"75%"}})},t)}))})},ht=function(e){var t=e.title,n=e.children,a=e.image;return Object(ee.jsxs)("div",{className:"section",children:[Object(ee.jsx)("h2",{className:"section-title",children:t}),Object(ee.jsxs)("div",{className:"content-container",children:[Object(ee.jsx)("div",{className:"section-content",children:n}),a&&Object(ee.jsx)("img",{className:"image",src:a.src,style:{width:a.scale,height:a.scale},alt:t})]})]})},pt=function(e){var t=e.title,n=e.children,a=e.visualContent;return Object(ee.jsxs)("div",{className:"section",children:[Object(ee.jsx)("h2",{className:"section-title",children:t}),Object(ee.jsxs)("div",{className:"content-container",children:[Object(ee.jsx)("div",{className:"section-content",children:n}),a]})]})},mt=[{path:A,backgroundColor:"orange"},{path:A,backgroundColor:"yellow"},{path:A,backgroundColor:"green"},{path:A,backgroundColor:"purple"}],bt=[{path:ue,backgroundColor:"orange"},{path:ue,backgroundColor:"yellow"},{path:ue,backgroundColor:"green"},{path:ue,backgroundColor:"purple"}],ft=[{path:ie,backgroundColor:"orange"},{path:ce,backgroundColor:"yellow"},{path:oe,backgroundColor:"green"},{path:se,backgroundColor:"purple"}],gt=[{path:Q,backgroundColor:"orange"},{path:q,backgroundColor:"yellow"},{path:Z,backgroundColor:"green"},{path:V,backgroundColor:"purple"}],jt=function(){return Object(ee.jsxs)("div",{className:"tutorial-page",children:[Object(ee.jsx)(ut,{title:"Welcome to Magic Maze Online"}),Object(ee.jsxs)(ht,{title:"Controls",image:{src:it,scale:"33%"},children:[Object(ee.jsx)("p",{children:"You can control any and every character with the moves that you are allowed. You can see your allowed moves in the sidebar, as well as the moves that your fellow players can do."}),Object(ee.jsx)("p",{children:"To start you can select a character using either Q to cycle selection of the characters or click on a specific character that you want to control."}),Object(ee.jsx)("p",{children:"There are multiple available moves: move up, move down, move left, move right, use the stairs, or teleport to any matching portal. You will have to coordinate with your teammates in order to move the characters where they need to go. In your first rounds of playing you can converse to each other using a voice/video technology like Zoom, Discord, Facetime or similar, but after you have gotten the hang of the game you will only be able to discuss amongst yourself after you pick up an hourglass timer, but only until the first person makes the next move."})]}),Object(ee.jsx)(pt,{title:"Color Coding",visualContent:Object(ee.jsx)(lt,{}),children:Object(ee.jsx)("p",{children:"Each player character has items or action tiles that correspond only to them, you can find them by matching colors. The Dwarf character corresponds to all tiles/items with an orange background, the Barbarian character corresponds to yellow, the Mage to purple, and the Elf to green. If a tile is color-coded to a character, no other character can use that tile."})}),Object(ee.jsx)(pt,{title:"Exploring",visualContent:Object(ee.jsx)(dt,{images:mt}),children:Object(ee.jsx)("p",{children:"To explore the maze and reveal new tiles, the character tokens have to be navigated to the exploration tiles, these can be found at the edge of the existing maze sections and have arrows pointing outwards. Each exploration tile is also color-coded to a specific character."})}),Object(ee.jsx)(pt,{title:"Weapons",visualContent:Object(ee.jsx)(dt,{images:gt}),children:Object(ee.jsx)("p",{children:"Each character has one specific weapon that they want to steal. There are two conditions before a weapon can be stolen: the sections have to all be explored, and all the characters have to be simultaneously standing on their weapon tiles."})}),Object(ee.jsx)(pt,{title:"Escaping",visualContent:Object(ee.jsx)(dt,{images:bt}),children:Object(ee.jsx)("p",{children:"Each character has their own color-coded exit tile that they need to get to before time runs out, this occurs after the weapon stealing phase. After the weapons have been stolen, the teleportation tiles are disabled however, making it a race to the finish."})}),Object(ee.jsx)(ht,{title:"Timers",image:{src:H,scale:"20%"},children:Object(ee.jsx)("p",{children:"The hourglass timers when picked up flip the timer. This means that the less time remaining when you pick up an hourglass, the more time you will have remaining afterwards. Example: when I pick up the timer with 5 seconds left, I will now have 1 min 55 seconds remaining; when I pick up the timer with 1:50 seconds left, I will now have 10 seconds remaining."})}),Object(ee.jsx)(pt,{title:"Teleportation Portals",visualContent:Object(ee.jsx)(dt,{images:ft}),children:Object(ee.jsx)("p",{children:"A teleportation portal allows character tokens to teleport to any matching colors, but only the character that matches the color-coding can use this portal. Press E to toggle the selected destination portal, press Return/Enter in order to teleport to the selected portal."})}),Object(ee.jsx)("div",{className:"conclusion",children:Object(ee.jsx)("p",{children:"Enjoy playing Magic Maze Online with your friends and explore the maze together!"})})]})};var yt=function(e){return e.playerName,e.setPlayerName,Object(ee.jsxs)("div",{className:"tutorial",children:[Object(ee.jsx)("h1",{className:"gameTitle",children:" Magic Maze"}),Object(ee.jsx)("div",{className:"tutorial-content",children:Object(ee.jsx)(jt,{})})]})};var vt=function(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(ee.jsx)(at.a,{children:Object(ee.jsxs)(Ze.c,{children:[Object(ee.jsx)(Ze.a,{path:"/game/:gameId",element:Object(ee.jsx)(nt,{realPlayerName:n})}),Object(ee.jsx)(Ze.a,{path:"/",element:Object(ee.jsx)(ot,{playerName:n,setPlayerName:r})}),Object(ee.jsx)(Ze.a,{path:"/tutorial",element:Object(ee.jsx)(yt,{})})]})})};i.a.render(Object(ee.jsx)(r.a.StrictMode,{}),document.getElementById("root")),i.a.render(Object(ee.jsx)(r.a.StrictMode,{children:Object(ee.jsx)(vt,{})}),document.getElementById("root"))}},[[45,1,2]]]);
//# sourceMappingURL=main.0da8b0b0.chunk.js.map